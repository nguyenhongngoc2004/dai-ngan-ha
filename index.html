<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Universe + Solar System</title>
<style>
body { margin:0; overflow:hidden; background:black; }
</style>
</head>

<body>
<script type="module">
import * as THREE from "https://cdn.skypack.dev/three@0.136.0";
import { OrbitControls } from "https://cdn.skypack.dev/three@0.136.0/examples/jsm/controls/OrbitControls";

/// ================= SCENE =================
const scene = new THREE.Scene();
scene.background = new THREE.Color('#160016');

const camera = new THREE.PerspectiveCamera(60, innerWidth/innerHeight, 1, 1000);
camera.position.set(0, 6, 26);

const renderer = new THREE.WebGLRenderer({ antialias:true });
renderer.setSize(innerWidth, innerHeight);
renderer.setPixelRatio(Math.min(devicePixelRatio, 2));
document.body.appendChild(renderer.domElement);

window.addEventListener("resize", ()=>{
  camera.aspect = innerWidth/innerHeight;
  camera.updateProjectionMatrix();
  renderer.setSize(innerWidth, innerHeight);
});

/// ================= CONTROLS =================
const controls = new OrbitControls(camera, renderer.domElement);
controls.enableDamping = true;
controls.enablePan = false;

/// ================= SOLAR SYSTEM =================
const solar = new THREE.Group();
scene.add(solar);

const sunLight = new THREE.PointLight(0xffffff, 2.2, 300);
solar.add(sunLight);

const sun = new THREE.Mesh(
  new THREE.SphereGeometry(2.6,32,32),
  new THREE.MeshStandardMaterial({
    emissive:0xffcc66,
    emissiveIntensity:1.4,
    color:0xffee99
  })
);
solar.add(sun);

scene.add(new THREE.AmbientLight(0x222222));

const planets = [];
function createStarRing(radius, count = 1400){
  const pos = [];
  const colors = [];

  // palette galaxy
  const galaxyColors = [
    new THREE.Color(0x6a5acd), // tím xanh
    new THREE.Color(0xc77dff), // tím hồng
    new THREE.Color(0xffb3c6), // hồng nhạt
    new THREE.Color(0x9bf6ff), // xanh nhạt
    new THREE.Color(0xffffff)  // sao trắng
  ];

  for(let i = 0; i < count; i++){
    const a = Math.random() * Math.PI * 2;
    const jitter = (Math.random() - 0.5) * 0.45;

    const x = Math.cos(a) * (radius + jitter);
    const y = (Math.random() - 0.5) * 0.6;
    const z = Math.sin(a) * (radius + jitter);

    pos.push(x, y, z);

    // chọn màu ngẫu nhiên + trộn nhẹ
    const baseColor = galaxyColors[Math.floor(Math.random() * galaxyColors.length)];
    const mixed = baseColor.clone().lerp(
      new THREE.Color(0xffffff),
      Math.random() * 0.4
    );

    colors.push(mixed.r, mixed.g, mixed.b);
  }

  const geo = new THREE.BufferGeometry();
  geo.setAttribute("position", new THREE.Float32BufferAttribute(pos, 3));
  geo.setAttribute("color", new THREE.Float32BufferAttribute(colors, 3));

  const mat = new THREE.PointsMaterial({
    size: 0.22,
    vertexColors: true,
    transparent: true,
    opacity: 0.85,
    blending: THREE.AdditiveBlending,
    depthWrite: false,
    depthTest: false
  });

  const ring = new THREE.Points(geo, mat);
  solar.add(ring);
}

  const ring = new THREE.Points(geo, mat);
  solar.add(ring);
}

const orbitRadii = [4, 6, 8, 10, 14, 18, 22];
orbitRadii.forEach(r => createStarRing(r));

function addPlanet(size, dist, speed, color){

  const pivot = new THREE.Object3D();
  const mesh = new THREE.Mesh(
    new THREE.SphereGeometry(size,32,32),
    new THREE.MeshStandardMaterial({ color, roughness:0.8 })
  );
  mesh.position.x = dist;
  pivot.add(mesh);
  pivot.userData.speed = speed;

  solar.add(pivot);
  planets.push(pivot);
}

/// 7 hành tinh
addPlanet(0.6, 4, 0.03, 0xaaaaaa);
addPlanet(0.9, 6, 0.022, 0xffcc88);
addPlanet(1.0, 8, 0.02, 0x2a5cff);
addPlanet(0.8, 10, 0.018, 0xff5533);
addPlanet(1.8, 14, 0.012, 0xffaa55);
addPlanet(1.4, 18, 0.01, 0xffe0aa);
addPlanet(1.2, 22, 0.008, 0x88ccff);

/// ================= ANIMATE =================
const clock = new THREE.Clock();

renderer.setAnimationLoop(()=>{
  let t = clock.getElapsedTime();
  planets.forEach(p=>{
    p.rotation.y += p.userData.speed;
  });

  controls.update();
  renderer.render(scene,camera);
});
</script>
</body>
</html>